<!DOCTYPE HTML>
<html lang="kr" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>스펠 외우기 - Casting SPELs Clojure - 한국어판</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="Casting SPELs Clojure - 한국어판">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../Index.html">처음</a></li><li class="chapter-item expanded affix "><li class="part-title">lisperati</li><li class="chapter-item expanded "><a href="../lisperati/00_lisperati.html">lisperati</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../lisperati/01_casting.html">Casting SPELs (Clojure)</a></li><li class="chapter-item expanded "><a href="../lisperati/02_syntax.html">신텍스</a></li><li class="chapter-item expanded "><a href="../lisperati/03_data.html">데이터</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../lisperati/03_data-cont.html">아톰</a></li></ol></li><li class="chapter-item expanded "><a href="../lisperati/04_looking.html">둘러보기</a></li><li class="chapter-item expanded "><a href="../lisperati/05_walking.html">돌아다녀보기</a></li><li class="chapter-item expanded "><a href="../lisperati/06_spels.html" class="active">스펠 외우기</a></li><li class="chapter-item expanded "><a href="../lisperati/07_actions.html">특별한 액션 만들기</a></li><li class="chapter-item expanded "><a href="../lisperati/08_addendum.html">부록</a></li><li class="chapter-item expanded "><a href="../lisperati/09_cheat.html">치트</a></li><li class="chapter-item expanded "><a href="../lisperati/10_ending.html">마치며</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Casting SPELs Clojure - 한국어판</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/lispkorea/casting-spels-clojure" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/lispkorea/casting-spels-clojure/edit/main/src/lisperati/06_spels.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="스펠-외우기"><a class="header" href="#스펠-외우기">스펠 외우기</a></h1>
<ul>
<li><a href="https://www.lisperati.com/spels.html">원문</a></li>
</ul>
<p>이제 리스프의 놀랍도록 강력한 기능을 배워보겠습니다: SPEL 만들기!</p>
<p>스펠(마법, <code>SPEL</code>)은 <code>S</code>emantic <code>P</code>rogram <code>E</code>nhancement <code>L</code>ogic의 줄임말로, 컴퓨터 코드의 세계 내부에 새로운 동작을 생성하여 필요에 맞게 동작을 사용자 정의하기 위해 기본적인 수준에서 Lisp 언어를 변경하는 것으로, Lisp에서 가장 마법처럼 보이는 부분입니다.
스펠을 사용하려면 먼저 리스프 컴파일러 내에서 스펠을 활성화 시켜야 합니다.</p>
<pre><code class="language-clojure">(defmacro def-스펠 [&amp; rest]
  `(defmacro ~@rest))
</code></pre>
<p>좋습니다. 이제 활성화 되었습니다. 이제 첫 스펠<code>이동</code>을 외워봅시다:</p>
<pre><code class="language-clojure">(def-스펠 이동 [방향]
  `(방향으로걷기! ~(keyword 방향)))
</code></pre>
<ul>
<li><code>keyword</code>
<ul>
<li>ex) <code>(keyword '서쪽)</code> =&gt; <code>:서쪽</code></li>
</ul>
</li>
</ul>
<p>이 코드가 하는 일은 리스프 컴파일러에게 <code>이동</code>라는 단어가 실제로는 <code>방향으로걷기!</code>라는 단어이며, 내부적으로 인자로 들어온 방향(ex <code>서쪽</code>)을 키워드방향(ex <code>:서쪽</code>)으로 만들어 줍니다.
코드를 완전히 컴파일하기 전에 다른 것으로 변경하는 특수한 코드를 프로그램과 컴파일러 사이에 몰래 삽입할 수 있습니다:</p>
<p><img src="../res/spel_compile.jpg" alt="" /></p>
<p>리스프에서는 코드와 데이터가 거의 동일하게 보입니다. 매우 일관되고 깔끔한 디자인입니다! 새로운 스펠을 사용해 봅시다:</p>
<pre><code class="language-clojure">&gt; (이동 서쪽)
;; (방향으로걷기! :서쪽)

[&quot;[아름다운 `정원`]: `우물`이 앞에 보인다&quot;
 &quot;`동쪽`으로 가는 문이 있다&quot;
 &quot;`개구리`(이/가) 바닦에 있다&quot;
 &quot;`사슬`(이/가) 바닦에 있다&quot;]
</code></pre>
<p>훨씬 나아졌습니다!</p>
<p>이제 게임 세상에서 오브젝트를 집는 함수를 만들어 보도록 하겠습니다:</p>
<pre><code class="language-clojure">(defn 오브젝트-집기! [오브젝트]
  (let [오브젝트이름 (name 오브젝트)]
    (if-not (오브젝트가-해당-장소에있는가? @atom_플레이어_사전_오브젝트_랑_장소 오브젝트 @atom_플레이어_현재장소)
      [(format &quot;여기에는 `%s`(이/가) 없습니다&quot; 오브젝트이름)]
      (do
        (swap! atom_플레이어_사전_오브젝트_랑_장소 assoc 오브젝트 :주인공-인벤토리)
        [(format &quot;`%s`(을/를) 집어들었습니다&quot; 오브젝트이름)]))))
</code></pre>
<p>이 함수는 오브젝트가 실제로 현재 위치의 바닥에 있는지 확인하고, 만약 그렇다면 <code>atom_플레이어_사전_오브젝트_랑_장소</code>를 갱신하고, 성공 여부를 알려주는 문장을 반환합니다.
갱신할때 <a href="./03_data-cont.html">앞서 배운</a> <code>swap!</code> 함수를 활용했습니다.
<code>atom_플레이어_사전_오브젝트_랑_장소</code>에 <code>assoc</code> 함수를 적용시키며, 인자로는 <code>오브젝트</code>와 <code>:주인공-인벤토리</code>를 넘겨주었습니다.</p>
<p>이 함수도 앞선 <code>방향으로걷기!</code>와 같이 키워드를 인자로 받기에, <code>이동</code> 스펠처럼 좀 더 쉽게 사용할 수 있는 다른 스펠을 시전해 보겠습니다:</p>
<pre><code class="language-clojure">(def-스펠 집어들기 [오브젝트]
  `(오브젝트-집기! ~(keyword 오브젝트)))
</code></pre>
<p>이제 새로운 스펠을 사용해 봅시다:</p>
<pre><code class="language-clojure">&gt; (집어들기 위스키)

[&quot;`위스키병`(을/를) 집어들었습니다&quot;]
</code></pre>
<p>이제 유용한 함수 몇개 더 추가해 보도록 하겠습니다. 우선 현재 플레이어가 가지고 있는 오브젝트 목록을 볼 수 있는 함수를 만들어 보겠습니다:</p>
<pre><code class="language-clojure">(defn 플레이어-오브젝트-리스트-가져오기 []
  (filter #(오브젝트가-해당-장소에있는가? @atom_플레이어_사전_오브젝트_랑_장소 % :주인공-인벤토리) 상수_리스트_모든오브젝트))
</code></pre>
<p>이제 플레이어가 특정 오브젝트를 가지고 있는지 알려주는 함수를 만들어 보겠습니다:</p>
<pre><code class="language-clojure">(defn 가지고있는가? [오브젝트]
  (-&gt;&gt; (플레이어-오브젝트-리스트-가져오기)
       (some #{오브젝트})
       (some?)))
</code></pre>
<p><code>some</code>과 <code>some?</code> 함수가 보입니다. 이 둘의 차이점은 무엇일까요?</p>
<ul>
<li><code>some</code>: 함수를 콜렉션의 각 요소에 적용하여, 하나라도 <code>true</code>이면 참을 반환, 아니면 <code>nil</code>을 반환
<ul>
<li>ex) <code>(some even? '(1 2 3 4))</code> =&gt; true</li>
</ul>
</li>
<li><code>some?</code>: nil이면 false, 아니면 true
<ul>
<li>ex) <code>(some? nil)</code> =&gt; <code>false</code></li>
</ul>
</li>
</ul>
<p>some함수의 반환값이 <code>true/false</code>가 아닌 <code>true/nil</code>이기에, <code>some?</code>을 사용하여 <code>true/false</code>로 변환해주는 것입니다.</p>
<h2 id="짚고넘어갈것"><a class="header" href="#짚고넘어갈것">짚고넘어갈것</a></h2>
<ul>
<li><a href="https://clojuredocs.org/clojure.core/defmacro">defmacro</a>
<ul>
<li><code>'</code>: <a href="https://clojuredocs.org/clojure.core/quote">quote</a></li>
<li>` : back-quoting</li>
<li><code>~</code>: <a href="https://clojuredocs.org/clojure.core/unquote">unquote</a></li>
<li><code>~@</code>: <a href="https://clojuredocs.org/clojure.core/unquote-splicing">unquote-splicing</a></li>
</ul>
</li>
<li><a href="https://clojuredocs.org/clojure.core/if">keyword</a></li>
<li><a href="https://clojuredocs.org/clojure.core/do">do</a></li>
<li><a href="https://clojuredocs.org/clojure.core/assoc">assoc</a></li>
<li><a href="https://clojuredocs.org/clojure.core/dissoc">dissoc</a></li>
<li><a href="https://clojuredocs.org/clojure.core/some">some</a></li>
<li><a href="https://clojuredocs.org/clojure.core/some_q">some?</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../lisperati/05_walking.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../lisperati/07_actions.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../lisperati/05_walking.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../lisperati/07_actions.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
